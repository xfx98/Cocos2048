require=function e(t,o,i){function r(c,n){if(!o[c]){if(!t[c]){var a="function"==typeof require&&require;if(!n&&a)return a(c,!0);if(s)return s(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var h=o[c]={exports:{}};t[c][0].call(h.exports,function(e){var o=t[c][1][e];return r(o||e)},h,h.exports,e,t,o,i)}return o[c].exports}for(var s="function"==typeof require&&require,c=0;c<i.length;c++)r(i[c]);return r}({GameRoot:[function(e,t,o){"use strict";cc._RF.push(t,"a370bXtLwVLZ7lyzdETAio/","GameRoot"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maskPanel=null,t.messageLabel=null,t.messageBtn1=null,t.messageBtn2=null,t.tipPanel=null,t.tipLabel=null,t}return __extends(t,e),t.prototype.showMaskMessage=function(e,t,o){var i=this;this.messageLabel.string=e,this.maskPanel.active||(this.maskPanel.active=!0),t?(this.messageBtn1.active=!0,this.messageBtn1.getComponent(cc.Label).string=t.label,this.messageBtn1.once(cc.Node.EventType.TOUCH_END,function(){i.hideMaskMessage(),t.cb&&t.cb()},t.target)):this.messageBtn1.active=!1,o?(this.messageBtn2.active=!0,this.messageBtn2.getComponent(cc.Label).string=o.label,this.messageBtn2.once(cc.Node.EventType.TOUCH_END,function(){i.hideMaskMessage(),o.cb&&o.cb()},o.target)):this.messageBtn2.active=!1},t.prototype.hideMaskMessage=function(){this.maskPanel.active=!1},t.prototype.showTip=function(e){this.tipLabel.string=e,this.tipPanel.getComponent(cc.Animation).play()},__decorate([s(cc.Node)],t.prototype,"maskPanel",void 0),__decorate([s(cc.Label)],t.prototype,"messageLabel",void 0),__decorate([s(cc.Node)],t.prototype,"messageBtn1",void 0),__decorate([s(cc.Node)],t.prototype,"messageBtn2",void 0),__decorate([s(cc.Node)],t.prototype,"tipPanel",void 0),__decorate([s(cc.Label)],t.prototype,"tipLabel",void 0),t=__decorate([r],t)}(cc.Component);o.GameRoot=c,cc._RF.pop()},{}],Get47Board:[function(e,t,o){"use strict";cc._RF.push(t,"4e746t6FElNd7L0fGocCm7k","Get47Board"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Get47Piece"),r=e("./Get47Constants"),s=cc._decorator,c=s.ccclass,n=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colsNum=7,t.rowsNum=7,t.padding=5,t.spacing=5,t.piecePrefab=null,t.get47Scene=null,t.runningAction=!1,t.score=0,t.inputDir=0,t}return __extends(t,e),t.prototype.init=function(e){this.get47Scene=e,this.pieceWidth=(this.node.width-2*this.padding-this.spacing*(this.colsNum-1))/this.colsNum},t.prototype.reset=function(){this.node.removeAllChildren(),this.pieceMap=[];for(var e=0;e<this.colsNum;e++){this.pieceMap[e]=[];for(var t=0;t<this.rowsNum;t++){var o=cc.instantiate(this.piecePrefab);this.node.addChild(o),o.width=this.pieceWidth,o.height=this.pieceWidth,o.position=cc.p(this.padding+e*(this.pieceWidth+this.spacing),this.padding+t*(this.pieceWidth+this.spacing));var r=o.getComponent(i.Piece);r.init(e,t),this.addTouchEvent(r),this.pieceMap[e][t]=r}}this.deletePieces()},t.prototype.addTouchEvent=function(e){var t=this,o=function(o){if(!t.runningAction){var i,s=o.getStartLocation(),c=o.getLocation();i=Math.abs(c.x-s.x)>Math.abs(c.y-s.y)?c.x>s.x?r.DIR.RIGHT:r.DIR.LEFT:c.y>s.y?r.DIR.UP:r.DIR.DOWN,t.inputDir=0,t.get47Scene.onPieceTouch(e,i)}};e.node.on(cc.Node.EventType.TOUCH_END,o,this),e.node.on(cc.Node.EventType.TOUCH_CANCEL,o,this)},t.prototype.tryExchange=function(e,t){var o=this,i=this.getNeighborPiece(e,t);if(null!==i){this.runningAction=!0,this.exchangeTwoPiecesState(e,i);var r=this.getHorizontalLines(),s=this.getVerticalLines();if(r.length+s.length>0){this.exchangeTwoPiecesPosIndex(e,i);var c=0,n=cc.sequence(cc.moveTo(.15,e.posIndex),cc.callFunc(function(){2===++c&&(o.runningAction=!1,o.deletePieces())})),a=cc.sequence(cc.moveTo(.15,i.posIndex),cc.callFunc(function(){2===++c&&(o.runningAction=!1,o.deletePieces())}));e.node.runAction(n),i.node.runAction(a)}else{this.exchangeTwoPiecesState(e,i);var p=0,h=e.node.position,u=i.node.position;n=cc.sequence(cc.moveTo(.1,u),cc.moveTo(.1,h),cc.callFunc(function(){2===++p&&(o.runningAction=!1)})),a=cc.sequence(cc.moveTo(.1,h),cc.moveTo(.1,u),cc.callFunc(function(){2===++p&&(o.runningAction=!1)}));e.node.runAction(n),i.node.runAction(a)}}},t.prototype.exchangeTwoPiecesState=function(e,t){var o,i;this.pieceMap[e.x][e.y]=t,this.pieceMap[t.x][t.y]=e,o=[t.x,e.x],e.x=o[0],t.x=o[1],i=[t.y,e.y],e.y=i[0],t.y=i[1]},t.prototype.exchangeTwoPiecesPosIndex=function(e,t){var o;o=[t.posIndex,e.posIndex],e.posIndex=o[0],t.posIndex=o[1]},t.prototype.deletePieces=function(){var e=this;this.runningAction=!0;var t=this.getHorizontalLines(),o=this.getVerticalLines();if(t.length+o.length!==0){for(var i=0,r=0,s=[],c=0,n=t;c<n.length;c++){var a=n[c];i+=a.type,s.push(a)}for(var p=0,h=o;p<h.length;p++){var u=h[p];r+=u.type,-1===s.indexOf(u)&&s.push(u)}this.inputDir>0?this.get47Scene.updateScore(i+r):this.inputDir<0?this.get47Scene.updateScore(-i-r):this.get47Scene.updateScore(i-r);for(var l=0,d=s.length,f=0;f<d;f++){var y=cc.sequence(cc.scaleTo(.15,0,0),cc.callFunc(function(){++l===d&&(e.runningAction=!1,e.fallPieces())}));s[f].isAlive=!1,s[f].node.runAction(y)}}else this.runningAction=!1},t.prototype.fallPieces=function(){var e=this;this.runningAction=!0;for(var t=!1;!t;){t=!0;for(var o=1;o<this.rowsNum;o++)for(var i=0;i<this.colsNum;i++)this.pieceMap[i][o].isAlive&&!this.pieceMap[i][o-1].isAlive&&(this.exchangeTwoPiecesState(this.pieceMap[i][o],this.pieceMap[i][o-1]),this.exchangeTwoPiecesPosIndex(this.pieceMap[i][o],this.pieceMap[i][o-1]),t=!1)}var r=[];for(i=0;i<this.colsNum;i++)for(o=0;o<this.rowsNum;o++)this.pieceMap[i][o].posIndex!==this.pieceMap[i][o].node.position&&r.push(this.pieceMap[i][o]);for(var s=0,c=r.length,n=0;n<c;n++){var a=cc.sequence(cc.moveTo(.3,r[n].posIndex),cc.callFunc(function(){++s==c&&(e.runningAction=!1,e.addPieces())}));r[n].node.runAction(a)}},t.prototype.addPieces=function(){var e=this;this.runningAction=!0;for(var t=[],o=0;o<this.rowsNum;o++)for(var i=0;i<this.colsNum;i++)this.pieceMap[i][o].isAlive||t.push(this.pieceMap[i][o]);for(var r=0,s=t.length,c=0;c<s;c++){var n=cc.sequence(cc.scaleTo(.15,1,1),cc.callFunc(function(){++r==s&&(e.runningAction=!1,e.deletePieces())}));t[c].randomType(),t[c].isAlive=!0,t[c].node.runAction(n)}},t.prototype.getVerticalLines=function(){for(var e=[],t=1,o=0;o<this.colsNum;o++)for(var i=0;i<this.rowsNum-2;i+=t){var r=this.pieceMap[o][i];t=1;for(var s=i+1;s<this.rowsNum&&this.pieceMap[o][s].type===r.type;s++)t++;if(t>=3)for(var c=0;c<t;c++)e.push(this.pieceMap[o][i+c])}return e},t.prototype.getHorizontalLines=function(){for(var e=[],t=1,o=0;o<this.rowsNum;o++)for(var i=0;i<this.colsNum-2;i+=t){var r=this.pieceMap[i][o].type;t=1;for(var s=i+1;s<this.colsNum&&this.pieceMap[s][o].type===r;s++)t++;if(t>=3)for(var c=0;c<t;c++)e.push(this.pieceMap[i+c][o])}return e},t.prototype.getNeighborPiece=function(e,t){var o=e.x,i=e.y;switch(t){case r.DIR.LEFT:if(o>0)return this.pieceMap[o-1][i];break;case r.DIR.RIGHT:if(o<this.colsNum-1)return this.pieceMap[o+1][i];break;case r.DIR.UP:if(i<this.rowsNum-1)return this.pieceMap[o][i+1];break;case r.DIR.DOWN:if(i>0)return this.pieceMap[o][i-1]}return null},t.prototype.newView=function(e){var t=this;if(void 0===e&&(e=0),this.inputDir=e,!this.runningAction){this.runningAction=!0;for(var o=0,i=0;i<this.colsNum;i++)for(var r=0;r<this.rowsNum;r++){var s=cc.sequence(cc.scaleTo(.3,0,0),cc.callFunc(function(){++o===(t.colsNum-1)*(t.rowsNum-1)&&(t.runningAction=!1,t.addPieces())}));this.pieceMap[i][r].isAlive=!1,this.pieceMap[i][r].node.runAction(s)}}},__decorate([n(cc.Integer)],t.prototype,"colsNum",void 0),__decorate([n(cc.Integer)],t.prototype,"rowsNum",void 0),__decorate([n(cc.Integer)],t.prototype,"padding",void 0),__decorate([n(cc.Integer)],t.prototype,"spacing",void 0),__decorate([n(cc.Prefab)],t.prototype,"piecePrefab",void 0),t=__decorate([c],t)}(cc.Component);o.Get47Board=a,cc._RF.pop()},{"./Get47Constants":"Get47Constants","./Get47Piece":"Get47Piece"}],Get47Constants:[function(e,t,o){"use strict";var i,r;cc._RF.push(t,"13fe4mwiuZGjaCf2paO8sE7","Get47Constants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.DIR||(o.DIR={}))[i.LEFT=1]="LEFT",i[i.UP=2]="UP",i[i.RIGHT=3]="RIGHT",i[i.DOWN=4]="DOWN",(r=o.STATE||(o.STATE={}))[r.NONE=0]="NONE",r[r.START=1]="START",r[r.OVER=2]="OVER",cc._RF.pop()},{}],Get47Piece:[function(e,t,o){"use strict";cc._RF.push(t,"fc55f3NtT5G+KpukC6ZPkmK","Get47Piece"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pics=[],t.sprite=null,t.x=0,t.y=0,t.posIndex=cc.v2(),t.isAlive=!0,t._n=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._n},set:function(e){this._n=e,this.sprite.spriteFrame=this.pics[e-1]},enumerable:!0,configurable:!0}),t.prototype.init=function(e,t){this.x=e,this.y=t,this.posIndex=this.node.position,this.randomType(),this.isAlive=!0},t.prototype.randomType=function(){this.type=Math.floor(Math.random()*this.pics.length)+1},__decorate([s([cc.SpriteFrame])],t.prototype,"pics",void 0),__decorate([s(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([r],t)}(cc.Component);o.Piece=c,cc._RF.pop()},{}],Get47Scene:[function(e,t,o){"use strict";cc._RF.push(t,"bff9a8PUMtCz7ZHZp5ezQ9T","Get47Scene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Get47Board"),r=e("./Get47Constants"),s=e("../G"),c=e("./Get47Score"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.score=null,t.target=47,t.state=r.STATE.NONE,t}return __extends(t,e),t.prototype.start=function(){this.board.init(this),this.startGame(),this.addListeners()},t.prototype.startGame=function(){this.state=r.STATE.START,this.board.reset(),this.score.reset(0)},t.prototype.overGame=function(){this.state=r.STATE.OVER,s.G.gameRoot.showMaskMessage("666",{label:"233",cb:function(){},target:this})},t.prototype.updateScore=function(e){this.state===r.STATE.START&&(e>0?this.score.add(e):e<0&&this.score.minus(-e),this.score.num===this.target&&this.overGame())},t.prototype.onPieceTouch=function(e,t){this.state===r.STATE.START&&this.board.tryExchange(e,t)},t.prototype.onBtnReturn=function(){s.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame()},t.prototype.addListeners=function(){cc.inputManager.setAccelerometerEnabled(!0),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this)},t.prototype.removeListeners=function(){cc.inputManager.setAccelerometerEnabled(!1)},t.prototype.onDeviceMotionEvent=function(e){Math.abs(e.acc.x)>.3&&Math.abs(e.acc.y)>.3&&this.board.newView()},__decorate([p(i.Get47Board)],t.prototype,"board",void 0),__decorate([p(c.Score)],t.prototype,"score",void 0),__decorate([p(cc.Integer)],t.prototype,"target",void 0),t=__decorate([a],t)}(cc.Component);o.Get47Scene=h,cc._RF.pop()},{"../G":"G","./Get47Board":"Get47Board","./Get47Constants":"Get47Constants","./Get47Score":"Get47Score"}],Get47Score:[function(e,t,o){"use strict";cc._RF.push(t,"51bd5D4aHJO/be6iKwDn88G","Get47Score"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.addLabel=null,t.minusLabel=null,t.anim=null,t.num=0,t}return __extends(t,e),t.prototype.reset=function(e){this.num=e,this.scoreLabel.string=e+""},t.prototype.add=function(e){this.num+=e,this.scoreLabel.string=this.num+"",this.addLabel.string="+"+e,this.anim.play("add")},t.prototype.minus=function(e){this.num-=e,this.scoreLabel.string=this.num+"",this.minusLabel.string="-"+e,this.anim.play("minus")},__decorate([s(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([s(cc.Label)],t.prototype,"addLabel",void 0),__decorate([s(cc.Label)],t.prototype,"minusLabel",void 0),__decorate([s(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([r],t)}(cc.Component);o.Score=c,cc._RF.pop()},{}],GobangAI:[function(e,t,o){"use strict";cc._RF.push(t,"718e4R2i4ZJIo5PjMMgEagd","GobangAI"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./GobangConstants"),r=function(){function e(e){this.board=e,this.fiveGroup=[],this.fiveGroupScore=[];for(var t=0;t<15;t++)for(var o=0;o<11;o++)this.fiveGroup.push([cc.v2(o,t),cc.v2(o+1,t),cc.v2(o+2,t),cc.v2(o+3,t),cc.v2(o+4,t)]);for(o=0;o<15;o++)for(t=0;t<11;t++)this.fiveGroup.push([cc.v2(o,t),cc.v2(o,t+1),cc.v2(o,t+2),cc.v2(o,t+3),cc.v2(o,t+4)]);for(var i=-10;i<=10;i++)for(o=0;o<11;o++)i+o<0||i+o>10||this.fiveGroup.push([cc.v2(o,i+o),cc.v2(o+1,i+o+1),cc.v2(o+2,i+o+2),cc.v2(o+3,i+o+3),cc.v2(o+4,i+o+4)]);for(i=4;i<=24;i++)for(t=0;t<11;t++)i-t<4||i-t>14||this.fiveGroup.push([cc.v2(i-t,t),cc.v2(i-t-1,t+1),cc.v2(i-t-2,t+2),cc.v2(i-t-3,t+3),cc.v2(i-t-4,t+4)])}return e.prototype.getNextCoor=function(){this.board.pieceMap;for(var e=0;e<this.fiveGroup.length;e++){for(var t=0,o=0,r=0;r<5;r++)this.board.getPieceByCoor(this.fiveGroup[e][r]).color===i.BLACK?t++:this.board.getPieceByCoor(this.fiveGroup[e][r]).color===i.WHITE&&o++;t+o==0?this.fiveGroupScore[e]=7:t>0&&o>0?this.fiveGroupScore[e]=0:0==t&&1==o?this.fiveGroupScore[e]=35:0==t&&2==o?this.fiveGroupScore[e]=800:0==t&&3==o?this.fiveGroupScore[e]=15e3:0==t&&4==o?this.fiveGroupScore[e]=8e5:0==o&&1==t?this.fiveGroupScore[e]=15:0==o&&2==t?this.fiveGroupScore[e]=400:0==o&&3==t?this.fiveGroupScore[e]=1800:0==o&&4==t&&(this.fiveGroupScore[e]=1e5)}var s=0,c=0;for(e=0;e<this.fiveGroupScore.length;e++)this.fiveGroupScore[e]>s&&(s=this.fiveGroupScore[e],c=e);var n=!1,a=!1,p=0;for(e=0;e<5;e++)if(n||this.board.getPieceByCoor(this.fiveGroup[c][e]).color!==i.NONE||(p=e),a||this.board.getPieceByCoor(this.fiveGroup[c][e]).color===i.NONE||(n=!0,a=!0),a&&this.board.getPieceByCoor(this.fiveGroup[c][e]).color===i.NONE){p=e;break}return this.fiveGroup[c][p]},e}();o.GobangAI=r,cc._RF.pop()},{"./GobangConstants":"GobangConstants"}],GobangBoard:[function(e,t,o){"use strict";cc._RF.push(t,"0c537hphVJHQ529UlnH6eF9","GobangBoard"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./GobangConstants"),r=e("./GobangPiece"),s=cc._decorator,c=s.ccclass,n=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colsSum=15,t.rowsSum=15,t.graphics=null,t.graphics2=null,t.tileWidth=0,t.startX=0,t.startY=0,t.boardWidth=0,t.boardHeight=0,t.lastPiece=null,t.gobangScene=null,t}return __extends(t,e),t.prototype.init=function(e){this.gobangScene=e,this.tileWidth=this.node.width/this.colsSum,this.startX=this.tileWidth/2,this.startY=this.tileWidth/2,this.boardWidth=this.tileWidth*(this.colsSum-1),this.boardHeight=this.tileWidth*(this.rowsSum-1),this.reset(),this.addListeners()},t.prototype.reset=function(){this.graphics.clear(),this.graphics2.clear(),this.graphics.strokeColor=cc.Color.BLACK;for(var e=0;e<this.colsSum;e++)this.graphics.moveTo(this.startX+e*this.tileWidth,this.startY),this.graphics.lineTo(this.startX+e*this.tileWidth,this.startY+this.boardHeight),this.graphics.stroke();for(var t=0;t<this.rowsSum;t++)this.graphics.moveTo(this.startX,this.startY+t*this.tileWidth),this.graphics.lineTo(this.startX+this.boardWidth,this.startY+t*this.tileWidth),this.graphics.stroke();this.graphics.strokeColor=cc.Color.RED,this.graphics.fillColor=cc.Color.RED;var o=Math.floor(this.colsSum/2),s=Math.floor(this.rowsSum/2);this.graphics.circle(this.startX+o*this.tileWidth,this.startY+s*this.tileWidth,5),this.graphics.fill(),this.pieceMap=[];for(t=0;t<this.rowsSum;t++){this.pieceMap[t]=[];for(e=0;e<this.colsSum;e++)this.pieceMap[t][e]=new r.GobangPiece(e,t,i.NONE)}},t.prototype.drawLastPieceRect=function(){this.graphics2.clear(),this.lastPiece&&(this.graphics2.strokeColor=cc.Color.RED,this.graphics2.rect(this.startX+this.tileWidth*this.lastPiece.x-this.tileWidth/2,this.startY+this.tileWidth*this.lastPiece.y-this.tileWidth/2,this.tileWidth,this.tileWidth),this.graphics2.stroke())},t.prototype.placeBlack=function(e){this.graphics.strokeColor=cc.Color.BLACK,this.graphics.fillColor=cc.Color.BLACK,this.graphics.circle(this.startX+e.x*this.tileWidth,this.startY+e.y*this.tileWidth,.45*this.tileWidth),this.graphics.fill(),this.pieceMap[e.x][e.y]=new r.GobangPiece(e.x,e.y,i.BLACK),this.lastPiece=this.pieceMap[e.x][e.y],this.drawLastPieceRect()},t.prototype.placeWhite=function(e){this.graphics.strokeColor=cc.Color.WHITE,this.graphics.fillColor=cc.Color.WHITE,this.graphics.circle(this.startX+e.x*this.tileWidth,this.startY+e.y*this.tileWidth,.45*this.tileWidth),this.graphics.fill(),this.pieceMap[e.x][e.y]=new r.GobangPiece(e.x,e.y,i.WHITE),this.lastPiece=this.pieceMap[e.x][e.y],this.drawLastPieceRect()},t.prototype.getPieceByCoor=function(e){return this.pieceMap[e.x][e.y]},t.prototype.onTouched=function(e){var t=this.node.convertToNodeSpaceAR(e.getLocation()),o=this.getCoorByPos(t);this.gobangScene.onBoardTouched(o)},t.prototype.getCoorByPos=function(e){var t=Math.round((e.x-this.startX)/this.tileWidth),o=Math.round((e.y-this.startY)/this.tileWidth);return cc.v2(t,o)},t.prototype.judgeWin=function(){for(var e=0,t=0;t<this.colsSum;t++)if(this.pieceMap[t][this.lastPiece.y].color===this.lastPiece.color){if(5===++e)return!0}else e=0;e=0;for(var o=0;o<this.rowsSum;o++)if(this.pieceMap[this.lastPiece.x][o].color===this.lastPiece.color){if(5==++e)return!0}else e=0;var i=this.lastPiece.y-this.lastPiece.x;e=0;for(t=0;t<this.colsSum;t++)if(!(i+t<0||i+t>=this.rowsSum))if(this.pieceMap[t][i+t].color===this.lastPiece.color){if(5==++e)return!0}else e=0;i=this.lastPiece.y+this.lastPiece.x,e=0;for(t=0;t<15;t++)if(!(i-t<0||i-t>=this.rowsSum))if(this.pieceMap[t][i-t].color===this.lastPiece.color){if(5==++e)return!0}else e=0;return!1},t.prototype.addListeners=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this)},t.prototype.removeListeners=function(){},__decorate([n(cc.Integer)],t.prototype,"colsSum",void 0),__decorate([n(cc.Integer)],t.prototype,"rowsSum",void 0),__decorate([n(cc.Graphics)],t.prototype,"graphics",void 0),__decorate([n(cc.Graphics)],t.prototype,"graphics2",void 0),t=__decorate([c],t)}(cc.Component);o.GobangBoard=a,cc._RF.pop()},{"./GobangConstants":"GobangConstants","./GobangPiece":"GobangPiece"}],GobangConstants:[function(e,t,o){"use strict";cc._RF.push(t,"4d1454ZxfBKuoBi2bCCS2eB","GobangConstants"),Object.defineProperty(o,"__esModule",{value:!0}),o.NONE=0,o.BLACK=1,o.WHITE=2,cc._RF.pop()},{}],GobangPiece:[function(e,t,o){"use strict";cc._RF.push(t,"b1aa3dPul9JxbYweTzmBe9T","GobangPiece"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(e,t,o){this.x=e,this.y=t,this.color=o};o.GobangPiece=i,cc._RF.pop()},{}],GobangScene:[function(e,t,o){"use strict";cc._RF.push(t,"2fcd3v+r05H8q3UVtZU7Lkf","GobangScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./GobangBoard"),r=e("./GobangConstants"),s=e("./GobangAI"),c=e("../G"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.ai=null,t.state=r.NONE,t}return __extends(t,e),t.prototype.start=function(){this.board.init(this),this.ai=new s.GobangAI(this.board),this.startGame()},t.prototype.startGame=function(){this.state=r.BLACK,this.board.reset(),c.G.gameRoot.showTip("你是黑棋你先走")},t.prototype.overGame=function(){this.state===r.BLACK?(cc.log("黑棋胜"),this.state=r.NONE,c.G.gameRoot.showMaskMessage("你赢了阿尔法二狗！",{label:"朕知道了",cb:function(){},target:this})):this.state===r.WHITE&&(cc.log("白旗胜"),c.G.gameRoot.showMaskMessage("你输给了阿尔法二狗！",{label:"服了",cb:function(){},target:this},{label:"不服",cb:function(){},target:this}),this.state=r.NONE)},t.prototype.onBtnReturn=function(){c.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame()},t.prototype.onBoardTouched=function(e){var t=this;switch(this.state){case r.NONE:break;case r.BLACK:if(this.board.getPieceByCoor(e).color!==r.NONE)return void c.G.gameRoot.showTip("这里有子了，你是不是傻");this.board.placeBlack(e),this.board.judgeWin()?this.overGame():(this.state=r.WHITE,this.scheduleOnce(function(){t.board.placeWhite(t.ai.getNextCoor()),t.board.judgeWin()?t.overGame():t.state=r.BLACK},1));break;case r.WHITE:}},__decorate([p(i.GobangBoard)],t.prototype,"board",void 0),t=__decorate([a],t)}(cc.Component);o.GobangScene=h,cc._RF.pop()},{"../G":"G","./GobangAI":"GobangAI","./GobangBoard":"GobangBoard","./GobangConstants":"GobangConstants"}],G:[function(e,t,o){"use strict";cc._RF.push(t,"409bcMsMydAJKg/yHU4OEJk","G"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){this.gameRoot=null}return e.prototype.enterHall=function(){cc.director.loadScene("hall")},e.prototype.returnHall=function(){cc.director.loadScene("hall")},e.prototype.enterGobang=function(){this.loadSceneWithProgress("gobang")},e.prototype.enterReversi=function(){this.loadSceneWithProgress("reversi")},e.prototype.enter2048=function(){this.loadSceneWithProgress("2048")},e.prototype.enterJump=function(){this.loadSceneWithProgress("jump")},e.prototype.enterPuzzle=function(){this.loadSceneWithProgress("puzzle")},e.prototype.enterGet47=function(){this.loadSceneWithProgress("get47")},e.prototype.enterTetris=function(){this.loadSceneWithProgress("tetris")},e.prototype.enterMine=function(){this.loadSceneWithProgress("mine")},e.prototype.setLoadingDisplay=function(){if(!cc.sys.isNative){var e=document.getElementById("splash"),t=e.querySelector(".progress-bar span");cc.loader.onProgress=function(e,o,i){var r=100*e/o;t&&(t.style.width=r.toFixed(2)+"%")},e.style.display="block",t.style.width="0%",cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){e.style.display="none"})}},e.prototype.loadSceneWithProgress=function(e,t){this.setLoadingDisplay(),cc.director.preloadScene(e,function(){setTimeout(function(){cc.director.loadScene(e,t)},1e3)})},e.Instance=new e,e}();o.G=i.Instance,cc._RF.pop()},{}],HallScene:[function(e,t,o){"use strict";cc._RF.push(t,"fd226wRnxRPpLNRLPUta677","HallScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../G"),r=cc._decorator,s=r.ccclass,c=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onBtnGobang=function(){i.G.enterGobang()},t.prototype.onBtnReversi=function(){i.G.enterReversi()},t.prototype.onBtn2048=function(){i.G.enter2048()},t.prototype.onBtnJump=function(){i.G.enterJump()},t.prototype.onBtnPuzzle=function(){i.G.enterPuzzle()},t.prototype.onBtnGet47=function(){i.G.enterGet47()},t.prototype.onBtnTetris=function(){i.G.enterTetris()},t.prototype.onBtnMine=function(){i.G.enterMine()},t=__decorate([s],t)}(cc.Component));o.HallScene=c,cc._RF.pop()},{"../G":"G"}],JumpBlock:[function(e,t,o){"use strict";cc._RF.push(t,"2f59bXfwKJPCLY3438CoYsJ","JumpBlock"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(e,t){this.head=e,this.length=t}return Object.defineProperty(e.prototype,"tail",{get:function(){return this.head+this.length-1},enumerable:!0,configurable:!0}),e}();o.Block=i,cc._RF.pop()},{}],JumpConstants:[function(e,t,o){"use strict";var i;cc._RF.push(t,"011d12M67BCB6Gv7D1zh1X3","JumpConstants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.STATE||(o.STATE={}))[i.NONE=0]="NONE",i[i.READY=1]="READY",i[i.START=2]="START",i[i.OVER=3]="OVER",cc._RF.pop()},{}],JumpPlayer:[function(e,t,o){"use strict";cc._RF.push(t,"b6b4dcrVKZGkYFaEw6tiwLd","JumpPlayer"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.power=0,t.initSpeed=0,t.jumpDistance=0,t.speed=0,t.isReadyJump=!1,t.direction=1,t}return __extends(t,e),t.prototype.readyJump=function(){this.node.runAction(cc.scaleTo(2,1,.5)),this.speed=this.initSpeed,this.isReadyJump=!0},t.prototype.jumpTo=function(e,t,o){var i=this;this.node.stopAllActions(),this.isReadyJump=!1;var r=cc.scaleTo(1,1,1),s=cc.jumpTo(.5,e,200,1),c=cc.callFunc(function(){i.speed=0,i.jumpDistance=0,t()},o);this.node.runAction(r),this.node.runAction(cc.sequence(s,c))},t.prototype.update=function(e){this.isReadyJump&&(this.speed+=e*this.power,this.jumpDistance+=this.speed*e)},__decorate([s(cc.Integer)],t.prototype,"power",void 0),__decorate([s(cc.Float)],t.prototype,"initSpeed",void 0),t=__decorate([r],t)}(cc.Component);o.Player=c,cc._RF.pop()},{}],JumpProgress:[function(e,t,o){"use strict";cc._RF.push(t,"5ecec+6EYpOOICro+tY1/xi","JumpProgress"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressBar=null,t.anchor=null,t.target=null,t.length=100,t}return __extends(t,e),t.prototype.init=function(e){this.length=e,this.anchor.x=0},t.prototype.show=function(){this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.updateProgress=function(e){return this.progressBar.progress=e/this.length,this.progressBar.progress>=.95?(this.anchor.x=this.node.width,!0):(this.anchor.x=this.node.getChildByName("bar").width,!1)},__decorate([s(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([s(cc.Node)],t.prototype,"anchor",void 0),__decorate([s(cc.Node)],t.prototype,"target",void 0),t=__decorate([r],t)}(cc.Component);o.Progress=c,cc._RF.pop()},{}],JumpScene:[function(e,t,o){"use strict";cc._RF.push(t,"7df288Am4VDaoxBjM38OlOw","JumpScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./JumpStage"),r=e("./JumpConstants"),s=e("./JumpProgress"),c=e("../G"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stage=null,t.progress=null,t.ignoreStoryButton=null,t.state=r.STATE.NONE,t}return __extends(t,e),t.prototype.start=function(){this.addListeners(),this.startGame()},t.prototype.startGame=function(){var e=this;this.state=r.STATE.READY,this.stage.init(this),this.stage.showStartStory(function(){e.ignoreStoryButton.active=!1,e.progress.init(200),e.progress.show(),e.state=r.STATE.START,e.stage.startGame()},this)},t.prototype.overGame=function(e){var t=this;e?(this.progress.hide(),this.state=r.STATE.OVER,this.stage.endGame(function(){c.G.gameRoot.showMaskMessage("原来我不是男主",{label:"打扰了",cb:function(){c.G.returnHall()},target:t})},this)):(this.state=r.STATE.OVER,c.G.gameRoot.showMaskMessage("缘已至此",{label:"放不下",cb:function(){t.stage.startGame(),t.state=r.STATE.START,t.progress.updateProgress(0)},target:this},{label:"算了吧",cb:function(){c.G.returnHall()},target:this}))},t.prototype.onScreenTouchStart=function(){this.state===r.STATE.START&&this.stage.playerReadyJump()},t.prototype.onScreenTouchEnd=function(){var e=this;this.state===r.STATE.START&&this.stage.playerJump(function(t,o){-1===t?(e.state=r.STATE.NONE,e.stage.playerDie(function(){e.overGame(!1)},e)):e.progress.updateProgress(t)?e.overGame(!0):o&&e.stage.addNewBlock()},this)},t.prototype.ignoreStory=function(){this.stage.ignoreStory()},t.prototype.addListeners=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onScreenTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onScreenTouchEnd,this)},t.prototype.removeListeners=function(){},__decorate([p(i.Stage)],t.prototype,"stage",void 0),__decorate([p(s.Progress)],t.prototype,"progress",void 0),__decorate([p(cc.Node)],t.prototype,"ignoreStoryButton",void 0),t=__decorate([a],t)}(cc.Component);o.JumpScene=h,cc._RF.pop()},{"../G":"G","./JumpConstants":"JumpConstants","./JumpProgress":"JumpProgress","./JumpStage":"JumpStage"}],JumpStage:[function(e,t,o){"use strict";cc._RF.push(t,"e3e700jxwtD1ao6LQTfMpyq","JumpStage"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./JumpBlock"),r=e("./JumpPlayer"),s=cc._decorator,c=s.ccclass,n=s.property,a=(s.executeInEditMode,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player=null,t.groundLayer=null,t.gridNum=20,t.g=null,t.minBlockSpace=1,t.maxBlockSpace=10,t.minBlockLength=1,t.maxBlockLength=7,t.cameraMoveDuration=1,t.endScene=null,t.jumpScene=null,t.gridWidth=32,t.groundOrigin=cc.v2(),t.offset=0,t.currBlock=null,t.nextBlock=null,t.playerIndex=null,t.animState=null,t.isMovingStage=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.gridWidth=Math.floor(this.groundLayer.width/this.gridNum),this.groundOrigin=this.groundLayer.position},t.prototype.init=function(e){this.jumpScene=e},t.prototype.showStartStory=function(e,t){this.g.clear(),this.drawBlock(new i.Block(0,5)),this.drawBlock(new i.Block(9,5));var o=this.getComponent(cc.Animation);o.once("finished",function(){e()},t),this.animState=o.play("start")},t.prototype.startGame=function(){this.reset()},t.prototype.endGame=function(e,t){var o=this;this.g.clear(),this.scheduleOnce(function(){o.endScene.active=!0},5),this.scheduleOnce(function(){o.player.node.getChildByName("name").getComponent(cc.Label).string=""},10),this.scheduleOnce(function(){o.player.node.children.forEach(function(e){e.color=cc.hexToColor("#58D639"),o.player.getComponent(cc.MotionStreak).color=cc.hexToColor("#58D639")})},15),this.scheduleOnce(function(){o.player.readyJump()},20),this.scheduleOnce(function(){var i=cc.v2(o.player.node.x-1e3,o.player.node.y);o.player.jumpTo(i,e,t)},25)},t.prototype.reset=function(){this.groundLayer.position=this.groundOrigin,this.g.clear(),this.currBlock=new i.Block(0,5),this.nextBlock=new i.Block(9,5),this.drawBlock(this.currBlock),this.drawBlock(this.nextBlock);var e=this.currBlock.head+Math.floor(this.currBlock.length/2);this.playerIndex=e,this.player.node.position=cc.v2(e*this.gridWidth+this.gridWidth/2,0),this.isMovingStage=!1},t.prototype.drawBlock=function(e){this.g.rect(e.head*this.gridWidth,-this.gridWidth,this.gridWidth*e.length,this.gridWidth),this.g.fill()},t.prototype.addNewBlock=function(){var e=this;this.moveStage(function(){e.currBlock=e.nextBlock;var t=Math.floor(e.minBlockSpace+Math.random()*(e.maxBlockSpace-e.minBlockSpace)),o=e.currBlock.head+e.currBlock.length+t,r=Math.floor(e.minBlockLength+Math.random()*(e.maxBlockLength-e.minBlockLength));e.nextBlock=new i.Block(o,r),e.drawBlock(e.nextBlock)},this)},t.prototype.moveStage=function(e,t){var o=this;this.isMovingStage=!0;var i=(this.nextBlock.head-this.currBlock.head)*this.gridWidth,r=cc.moveBy(this.cameraMoveDuration,-i,0),s=cc.sequence(r,cc.callFunc(function(){o.isMovingStage=!1,e()},t));this.groundLayer.runAction(s)},t.prototype.canReadyJump=function(){return!this.isMovingStage&&0===this.player.speed},t.prototype.playerReadyJump=function(){this.canReadyJump()&&this.player.readyJump()},t.prototype.ignoreStory=function(){this.animState.speed=4},t.prototype.playerDie=function(e,t){var o=cc.sequence(cc.moveBy(1,0,-1e3),cc.callFunc(e,t));this.player.node.runAction(o)},t.prototype.playerJump=function(e,t){var o=this;if(this.player.isReadyJump){var i=Math.round(this.player.jumpDistance/this.gridWidth),r=this.playerIndex+i,s=cc.v2(this.gridWidth*r+this.gridWidth/2,0);this.player.jumpTo(s,function(){o.playerIndex=r,r<=o.currBlock.tail?e(o.playerIndex,!1):r>=o.nextBlock.head&&r<=o.nextBlock.tail?e(o.playerIndex,!0):e(-1,!1)},this)}},__decorate([n(r.Player)],t.prototype,"player",void 0),__decorate([n(cc.Node)],t.prototype,"groundLayer",void 0),__decorate([n(cc.Integer)],t.prototype,"gridNum",void 0),__decorate([n(cc.Graphics)],t.prototype,"g",void 0),__decorate([n(cc.Integer)],t.prototype,"minBlockSpace",void 0),__decorate([n(cc.Integer)],t.prototype,"maxBlockSpace",void 0),__decorate([n(cc.Integer)],t.prototype,"minBlockLength",void 0),__decorate([n(cc.Integer)],t.prototype,"maxBlockLength",void 0),__decorate([n(cc.Float)],t.prototype,"cameraMoveDuration",void 0),__decorate([n(cc.Node)],t.prototype,"endScene",void 0),t=__decorate([c],t)}(cc.Component));o.Stage=a,cc._RF.pop()},{"./JumpBlock":"JumpBlock","./JumpPlayer":"JumpPlayer"}],LodingScene:[function(e,t,o){"use strict";cc._RF.push(t,"118a2LRWWBIKY9afEfjWW/h","LodingScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../G"),r=e("../shared/GameRoot"),s=cc._decorator,c=s.ccclass,n=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipLabel=null,t.gameRoot=null,t}return __extends(t,e),t.prototype.onLoad=function(){cc.game.addPersistRootNode(this.gameRoot),this.initGlobal()},t.prototype.initGlobal=function(){i.G.gameRoot=this.gameRoot.getComponent(r.GameRoot)},t.prototype.start=function(){var e=this;cc.director.setDisplayStats(!1);var t="始终相信美好的事情不会发生",o=0;this.tipLabel.string="",this.schedule(function(){++o===t.length+1?e.onLoadSuccess():e.tipLabel.string=t.substring(0,o)},.3,t.length+1,.3)},t.prototype.onLoadSuccess=function(){i.G.enterHall()},__decorate([n(cc.Label)],t.prototype,"tipLabel",void 0),__decorate([n(cc.Node)],t.prototype,"gameRoot",void 0),t=__decorate([c],t)}(cc.Component);o.LodingScene=a,cc._RF.pop()},{"../G":"G","../shared/GameRoot":"GameRoot"}],M2048Board:[function(e,t,o){"use strict";cc._RF.push(t,"8daa0Je3Z9NaKuqNJt/x5E8","M2048Board"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./M2048Piece"),r=e("./M2048Constants"),s=cc._decorator,c=s.ccclass,n=s.property,a=s.executeInEditMode,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colsSum=4,t.rowsSum=4,t.graphics=null,t.piecePrefab=null,t.pieceLayer=null,t.tileWidth=0,t.startX=0,t.startY=0,t.boardWidth=0,t.boardHeight=0,t.m2048Scene=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.tileWidth=this.node.width/(this.colsSum+1),this.startX=this.tileWidth/2,this.startY=this.tileWidth/2,this.boardWidth=this.tileWidth*this.colsSum,this.boardHeight=this.tileWidth*this.rowsSum,this.graphics.clear(),this.graphics.strokeColor=cc.Color.BLACK;for(var e=0;e<this.colsSum+1;e++)this.graphics.moveTo(this.startX+e*this.tileWidth,this.startY),this.graphics.lineTo(this.startX+e*this.tileWidth,this.startY+this.boardHeight),this.graphics.stroke();for(var t=0;t<this.rowsSum+1;t++)this.graphics.moveTo(this.startX,this.startY+t*this.tileWidth),this.graphics.lineTo(this.startX+this.boardWidth,this.startY+t*this.tileWidth),this.graphics.stroke();this.pieceLayer.removeAllChildren(),this.pieceMap=[];for(e=0;e<this.colsSum;e++){this.pieceMap[e]=[];for(t=0;t<this.rowsSum;t++){var o=cc.instantiate(this.piecePrefab).getComponent(i.M2048Piece);o.node.parent=this.pieceLayer,o.node.x=this.startX+e*this.tileWidth+this.tileWidth/2,o.node.y=this.startY+t*this.tileWidth+this.tileWidth/2,this.pieceMap[e][t]=o,o.init(e,e,0)}}},t.prototype.init=function(e){this.m2048Scene=e,this.reset(),this.addListeners()},t.prototype.reset=function(){for(var e=0;e<this.colsSum;e++)for(var t=0;t<this.rowsSum;t++)this.pieceMap[e][t].n=0;for(var o=0;o<2;o++)this.newPiece()},t.prototype.newPiece=function(){for(var e=[],t=0;t<this.colsSum;t++)for(var o=0;o<this.rowsSum;o++)0===this.pieceMap[t][o].n&&e.push(this.pieceMap[t][o]);e[Math.floor(Math.random()*e.length)].randomNumber()},t.prototype.judgeOver=function(){for(var e=0;e<this.rowsSum;e++)for(var t=0;t<this.colsSum;t++){if(0===this.pieceMap[t][e].n)return!1;if(t<=this.colsSum-2&&this.pieceMap[t][e].n===this.pieceMap[t+1][e].n)return!1;if(e<=this.rowsSum-2&&this.pieceMap[t][e].n===this.pieceMap[t][e+1].n)return!1}return!0},t.prototype.getMaxNLabel=function(){for(var e=2,t="2",o=0;o<this.colsSum;o++)for(var i=0;i<this.rowsSum;i++)this.pieceMap[o][i].n>e&&(e=this.pieceMap[o][i].n,t=this.pieceMap[o][i].nLabel.string);return t},t.prototype.slideLeft=function(){for(var e=!1,t=0;t<this.rowsSum;t++)for(var o=0;o<this.colsSum;o++)if(0!==this.pieceMap[o][t].n)for(var i=o+1;i<this.colsSum;i++)if(0!==this.pieceMap[i][t].n){if(this.pieceMap[o][t].n===this.pieceMap[i][t].n){this.pieceMap[o][t].n*=2,this.pieceMap[i][t].n=0,e=!0;break}break}for(t=0;t<this.rowsSum;t++)for(o=0;o<this.colsSum;o++)if(0===this.pieceMap[o][t].n)for(i=o+1;i<this.rowsSum;i++)if(0!==this.pieceMap[i][t].n){this.pieceMap[o][t].n=this.pieceMap[i][t].n,this.pieceMap[i][t].n=0,e=!0;break}return e&&this.newPiece(),e},t.prototype.slideRight=function(){for(var e=!1,t=0;t<this.rowsSum;t++)for(var o=this.colsSum-1;o>=0;o--)if(0!==this.pieceMap[o][t].n)for(var i=o-1;i>=0;i--)if(0!==this.pieceMap[i][t].n){if(this.pieceMap[o][t].n===this.pieceMap[i][t].n){this.pieceMap[o][t].n=2*this.pieceMap[o][t].n,this.pieceMap[i][t].n=0,e=!0;break}break}for(t=0;t<this.rowsSum;t++)for(o=this.colsSum-1;o>=0;o--)if(0===this.pieceMap[o][t].n)for(i=o-1;i>=0;i--)if(0!==this.pieceMap[i][t].n){this.pieceMap[o][t].n=this.pieceMap[i][t].n,this.pieceMap[i][t].n=0,e=!0;break}return e&&this.newPiece(),e},t.prototype.slideDown=function(){for(var e=!1,t=0;t<this.colsSum;t++)for(var o=0;o<this.rowsSum;o++)if(0!==this.pieceMap[t][o].n)for(var i=o+1;i<4;i++)if(0!==this.pieceMap[t][i].n){if(this.pieceMap[t][o].n===this.pieceMap[t][i].n){this.pieceMap[t][o].n=2*this.pieceMap[t][o].n,this.pieceMap[t][i].n=0,e=!0;break}break}for(t=0;t<this.colsSum;t++)for(o=0;o<this.rowsSum;o++)if(0===this.pieceMap[t][o].n)for(i=o+1;i<this.rowsSum;i++)if(0!==this.pieceMap[t][i].n){this.pieceMap[t][o].n=this.pieceMap[t][i].n,this.pieceMap[t][i].n=0,e=!0;break}return e&&this.newPiece(),e},t.prototype.slideUp=function(){for(var e=!1,t=0;t<this.colsSum;t++)for(var o=this.rowsSum-1;o>=0;o--)if(0!==this.pieceMap[t][o].n)for(var i=o-1;i>=0;i--)if(0!==this.pieceMap[t][i].n){if(this.pieceMap[t][o].n===this.pieceMap[t][i].n){this.pieceMap[t][o].n=2*this.pieceMap[t][o].n,this.pieceMap[t][i].n=0,e=!0;break}break}for(t=0;t<this.colsSum;t++)for(o=this.rowsSum-1;o>=0;o--)if(0==this.pieceMap[t][o].n)for(i=o-1;i>=0;i--)if(0!=this.pieceMap[t][i].n){this.pieceMap[t][o].n=this.pieceMap[t][i].n,this.pieceMap[t][i].n=0,e=!0;break}return e&&this.newPiece(),e},t.prototype.onTouched=function(e){var t=e.getStartLocation(),o=e.getLocation(),i=o.x-t.x,s=o.y-t.y;Math.abs(i)>Math.abs(s)?i>40?this.m2048Scene.onBoardSlid(r.DIR.RIGHT):i<-40&&this.m2048Scene.onBoardSlid(r.DIR.LEFT):s>40?this.m2048Scene.onBoardSlid(r.DIR.UP):s<-40&&this.m2048Scene.onBoardSlid(r.DIR.DOWN)},t.prototype.onKey=function(e){switch(e.keyCode){case cc.KEY.up:case cc.KEY.w:this.m2048Scene.onBoardSlid(r.DIR.UP);break;case cc.KEY.down:case cc.KEY.s:this.m2048Scene.onBoardSlid(r.DIR.DOWN);break;case cc.KEY.left:case cc.KEY.a:this.m2048Scene.onBoardSlid(r.DIR.LEFT);break;case cc.KEY.right:case cc.KEY.d:this.m2048Scene.onBoardSlid(r.DIR.RIGHT)}},t.prototype.addListeners=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKey,this)},t.prototype.removeListeners=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKey,this)},__decorate([n(cc.Integer)],t.prototype,"colsSum",void 0),__decorate([n(cc.Integer)],t.prototype,"rowsSum",void 0),__decorate([n(cc.Graphics)],t.prototype,"graphics",void 0),__decorate([n(cc.Prefab)],t.prototype,"piecePrefab",void 0),__decorate([n(cc.Node)],t.prototype,"pieceLayer",void 0),t=__decorate([c,a],t)}(cc.Component);o.M2048Board=p,cc._RF.pop()},{"./M2048Constants":"M2048Constants","./M2048Piece":"M2048Piece"}],M2048Constants:[function(e,t,o){"use strict";var i,r;cc._RF.push(t,"ae1feSJm35PO7NFsru97cE/","M2048Constants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.DIR||(o.DIR={}))[i.LEFT=1]="LEFT",i[i.UP=2]="UP",i[i.RIGHT=3]="RIGHT",i[i.DOWN=4]="DOWN",(r=o.STATE||(o.STATE={}))[r.NONE=0]="NONE",r[r.START=1]="START",r[r.OVER=2]="OVER",cc._RF.pop()},{}],M2048Piece:[function(e,t,o){"use strict";cc._RF.push(t,"cb9b4J96u9N86ZDPdyznPbw","M2048Piece"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nLabel=null,t._n=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"n",{get:function(){return this._n},set:function(e){var t,o;switch(this._n=e,e){case 0:o="",t=cc.Color.BLACK;break;case 2:o="幼儿园",t=cc.hexToColor("#784212");break;case 4:o="小学生",t=cc.hexToColor("#784212");break;case 8:o="初中生",t=cc.hexToColor("#7E5109");break;case 16:o="高中生",t=cc.hexToColor("#7D6608");break;case 32:o="大学生",t=cc.hexToColor("#186A3B");break;case 64:o="研究生",t=cc.hexToColor("#145A32");break;case 128:o="硕士生",t=cc.hexToColor("#0B5345");break;case 256:o="博士生",t=cc.hexToColor("#0E6251");break;case 512:o="实习生",t=cc.hexToColor("#1B4F72");break;case 1024:o="码农",t=cc.hexToColor("#154360");break;case 2048:o="码神",t=cc.hexToColor("#4A235A");break;case 4096:o="女装大佬",t=cc.hexToColor("#512E5F");break;case 8192:o="众生平等",t=cc.hexToColor("#78281F");break;default:o="开挂吧你",t=cc.hexToColor("#641E16")}this.nLabel.string=o,this.nLabel.node.color=t},enumerable:!0,configurable:!0}),t.prototype.init=function(e,t,o){this.x=e,this.y=t,this.n=o},t.prototype.randomNumber=function(){this.n=Math.random()<.9?2:4},t.prototype.getHcolor=function(e,t){var o=t/6,i=0,r=0,s=0,c=0;return e<1*o?(i=e/o*255,r=255,s=0,c=Math.round(i)):e>=o&&e<2*o?(i=255-(e-o)/o*255,r=Math.round(i),s=0,c=255):e>=2*o&&e<3*o?(i=(e-2*o)/o*255,r=0,s=Math.round(i),c=255):e>=3*o&&e<4*o?(i=255-(e-3*o)/o*255,r=0,s=255,c=Math.round(i)):e>=4*o&&e<5*o?(i=(e-4*o)/o*255,r=Math.round(i),s=255,c=0):(i=255-(e-5*o)/o*255,r=255,s=Math.round(i),c=0),cc.color(r,s,c)},__decorate([s(cc.Label)],t.prototype,"nLabel",void 0),t=__decorate([r],t)}(cc.Component);o.M2048Piece=c,cc._RF.pop()},{}],M2048Scene:[function(e,t,o){"use strict";cc._RF.push(t,"d6ad1DvUutCO5e9tw6UJExv","M2048Scene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./M2048Board"),r=e("../G"),s=e("./M2048Constants"),c=cc._decorator,n=c.ccclass,a=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.state=s.STATE.NONE,t}return __extends(t,e),t.prototype.start=function(){this.board.init(this),this.startGame()},t.prototype.startGame=function(){this.state=s.STATE.START,this.board.reset(),r.G.gameRoot.showTip("四方向手势滑动")},t.prototype.overGame=function(){var e=this.board.getMaxNLabel();r.G.gameRoot.showMaskMessage(e,{label:"OK",cb:function(){},target:this}),this.state=s.STATE.OVER},t.prototype.onBtnReturn=function(){r.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame()},t.prototype.onBoardSlid=function(e){var t=!1;switch(e){case s.DIR.LEFT:t=this.board.slideLeft();break;case s.DIR.RIGHT:t=this.board.slideRight();break;case s.DIR.UP:t=this.board.slideUp();break;case s.DIR.DOWN:t=this.board.slideDown();break;default:cc.error("方向错误")}t&&this.board.judgeOver()&&this.overGame()},__decorate([a(i.M2048Board)],t.prototype,"board",void 0),t=__decorate([n],t)}(cc.Component);o.M2048Scene=p,cc._RF.pop()},{"../G":"G","./M2048Board":"M2048Board","./M2048Constants":"M2048Constants"}],MineConstans:[function(e,t,o){"use strict";var i,r,s;cc._RF.push(t,"377f1wDS+ZNiK34Bo00vs8d","MineConstans"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.STATE||(o.STATE={}))[i.NONE=0]="NONE",i[i.START=1]="START",i[i.OVER=2]="OVER",(r=o.PIECE_TYPE||(o.PIECE_TYPE={}))[r.OPEN0=0]="OPEN0",r[r.OPEN1=1]="OPEN1",r[r.OPEN2=2]="OPEN2",r[r.OPEN3=3]="OPEN3",r[r.OPEN4=4]="OPEN4",r[r.OPEN5=5]="OPEN5",r[r.OPEN6=6]="OPEN6",r[r.OPEN7=7]="OPEN7",r[r.OPEN8=8]="OPEN8",r[r.BOMB=9]="BOMB",(s=o.PIECE_STATE||(o.PIECE_STATE={}))[s.PENDING=1]="PENDING",s[s.FLAG=2]="FLAG",s[s.OPEN=3]="OPEN",cc._RF.pop()},{}],MineLevelLabel:[function(e,t,o){"use strict";cc._RF.push(t,"4079avk3fFC/530/cecMnYc","MineLevelLabel"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.s1=null,t.s2=null,t.nums=[],t._level=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e;var t=e/10|0,o=e%10;this.s1.spriteFrame=this.nums[t],this.s2.spriteFrame=this.nums[o]},enumerable:!0,configurable:!0}),__decorate([s(cc.Sprite)],t.prototype,"s1",void 0),__decorate([s(cc.Sprite)],t.prototype,"s2",void 0),__decorate([s([cc.SpriteFrame])],t.prototype,"nums",void 0),t=__decorate([r],t)}(cc.Component);o.MineLevelLabel=c,cc._RF.pop()},{}],MinePiece:[function(e,t,o){"use strict";cc._RF.push(t,"813feimwL1NhqxaGQMpXWGV","MinePiece"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./MineConstans"),r=cc._decorator,s=r.ccclass,c=r.property,n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pieceSprite=null,t.picPending=null,t.picFlag=null,t.picDeath=null,t.picOpen0=null,t.picOpen1=null,t.picOpen2=null,t.picOpen3=null,t.picOpen4=null,t.picOpen5=null,t.picOpen6=null,t.picOpen7=null,t.picOpen8=null,t.x=0,t.y=0,t._state=i.PIECE_STATE.PENDING,t._type=i.PIECE_TYPE.OPEN0,t}return __extends(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){switch(this._state=e,this.state){case i.PIECE_STATE.PENDING:this.pieceSprite.spriteFrame=this.picPending;break;case i.PIECE_STATE.FLAG:this.pieceSprite.spriteFrame=this.picFlag;break;case i.PIECE_STATE.OPEN:this.setSpriteByType();break;default:cc.error("unknown state!")}},enumerable:!0,configurable:!0}),t.prototype.setSpriteByType=function(){switch(this.type){case i.PIECE_TYPE.OPEN0:this.pieceSprite.spriteFrame=this.picOpen0;break;case i.PIECE_TYPE.OPEN1:this.pieceSprite.spriteFrame=this.picOpen1;break;case i.PIECE_TYPE.OPEN2:this.pieceSprite.spriteFrame=this.picOpen2;break;case i.PIECE_TYPE.OPEN3:this.pieceSprite.spriteFrame=this.picOpen3;break;case i.PIECE_TYPE.OPEN4:this.pieceSprite.spriteFrame=this.picOpen4;break;case i.PIECE_TYPE.OPEN5:this.pieceSprite.spriteFrame=this.picOpen5;break;case i.PIECE_TYPE.OPEN6:this.pieceSprite.spriteFrame=this.picOpen6;break;case i.PIECE_TYPE.OPEN7:this.pieceSprite.spriteFrame=this.picOpen7;break;case i.PIECE_TYPE.OPEN8:this.pieceSprite.spriteFrame=this.picOpen8;break;case i.PIECE_TYPE.BOMB:this.pieceSprite.spriteFrame=this.picDeath}},Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,this.setSpriteByType()},enumerable:!0,configurable:!0}),t.prototype.init=function(e,t,o,i){this.x=e,this.y=t,this.state=i,this.type=o},__decorate([c(cc.Sprite)],t.prototype,"pieceSprite",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picPending",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picFlag",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picDeath",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen0",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen1",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen2",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen3",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen4",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen5",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen6",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen7",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"picOpen8",void 0),t=__decorate([s],t)}(cc.Component);o.Piece=n,cc._RF.pop()},{"./MineConstans":"MineConstans"}],MineScene:[function(e,t,o){"use strict";cc._RF.push(t,"67198fHIXNKkbYuV6JCgYzA","MineScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./MnieBoard"),r=e("../G"),s=e("./MineConstans"),c=e("./MineLevelLabel"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.bombNumLabel=null,t.flagNumLabel=null,t.levelLabel=null,t.state=s.STATE.NONE,t.level=1,t.maxLevel=20,t}return __extends(t,e),t.prototype.start=function(){this.board.init(this),this.maxLevel=this.board.getMaxLevel(),this.startGame(1)},t.prototype.startGame=function(e){this.level=e,this.state=s.STATE.START,this.board.reset(e),this.levelLabel.level=e,this.bombNumLabel.string=this.board.getBombNum()+"",this.flagNumLabel.string=this.board.getFlagNum()+""},t.prototype.overGame=function(e){var t=this;this.state=s.STATE.OVER,e?this.level===this.maxLevel?r.G.gameRoot.showMaskMessage("恭喜通关!\n获得雷公称号!",{label:"233",cb:function(){r.G.returnHall()},target:this}):r.G.gameRoot.showMaskMessage("恭喜通过第"+this.level+"关!",{label:"下一关",cb:function(){t.level++,t.startGame(t.level)},target:this},{label:"不玩了",cb:function(){r.G.returnHall()},target:this}):r.G.gameRoot.showMaskMessage("你死在了第"+this.level+"关!",{label:"续命",cb:function(){t.startGame(t.level)},target:this},{label:"不玩了",cb:function(){r.G.returnHall()},target:this})},t.prototype.onClickPiece=function(e){if(this.state===s.STATE.START){this.board.openPiece(e);var t=this.board.getBombNum();this.bombNumLabel.string=t+""}},t.prototype.onPressPiece=function(e){if(this.state===s.STATE.START){this.board.flagPiece(e);var t=this.board.getFlagNum();this.flagNumLabel.string=t+""}},t.prototype.onBtnReturn=function(){r.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame(this.level)},__decorate([p(i.Board)],t.prototype,"board",void 0),__decorate([p(cc.Label)],t.prototype,"bombNumLabel",void 0),__decorate([p(cc.Label)],t.prototype,"flagNumLabel",void 0),__decorate([p(c.MineLevelLabel)],t.prototype,"levelLabel",void 0),t=__decorate([a],t)}(cc.Component);o.MineScene=h,cc._RF.pop()},{"../G":"G","./MineConstans":"MineConstans","./MineLevelLabel":"MineLevelLabel","./MnieBoard":"MnieBoard"}],MnieBoard:[function(e,t,o){"use strict";cc._RF.push(t,"d5dcaOV26xKp7PBWPzaeZRU","MnieBoard"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./MinePiece"),r=e("./MineConstans"),s=cc._decorator,c=s.ccclass,n=s.property,a=s.executeInEditMode,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.piecePrefab=null,t.colNum=9,t.colSpace=9,t.pressTime=1,t.colWidth=80,t.touchingPiece=null,t.touchStartTime=0,t.bombNum=0,t.flagNum=0,t.mineScene=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.colWidth=(this.node.width-this.colSpace*(this.colNum+1))/this.colNum,this.node.removeAllChildren(),this.pieceMap=[];for(var t=function(t){o.pieceMap[t]=[];for(var s=function(s){var c=cc.instantiate(o.piecePrefab);o.node.addChild(c),c.x=t*(o.colWidth+o.colSpace)+o.colSpace,c.y=s*(o.colWidth+o.colSpace)+o.colSpace,c.width=o.colWidth,c.height=o.colWidth,o.pieceMap[t][s]=c.getComponent(i.Piece),o.pieceMap[t][s].init(t,s,r.PIECE_TYPE.OPEN0,r.PIECE_STATE.OPEN),c.on(cc.Node.EventType.TOUCH_START,function(){e.onPieceTouchStart(e.pieceMap[t][s])},o),c.on(cc.Node.EventType.TOUCH_END,function(){e.onPieceTouchEnd(e.pieceMap[t][s])},o)},c=0;c<o.colNum;c++)s(c)},o=this,s=0;s<this.colNum;s++)t(s)},t.prototype.init=function(e){this.mineScene=e},t.prototype.onPieceTouchStart=function(e){this.touchStartTime=(new Date).getTime(),this.touchingPiece=e},t.prototype.onPieceTouchEnd=function(e){(new Date).getTime()-this.touchStartTime>1e3*this.pressTime?this.mineScene.onPressPiece(e):this.mineScene.onClickPiece(e)},t.prototype.openPiece=function(e){e.state===r.PIECE_STATE.PENDING&&(e.type===r.PIECE_TYPE.BOMB?(e.state=r.PIECE_STATE.OPEN,this.showAll(),this.mineScene.overGame(!1)):(this.showBlank(e),this.judgeWin()))},t.prototype.flagPiece=function(e){if(e.state===r.PIECE_STATE.PENDING){if(e.state=r.PIECE_STATE.FLAG,this.flagNum--,0===this.flagNum){var t=this.showRest();this.mineScene.overGame(t)}}else e.state===r.PIECE_STATE.FLAG&&(e.state=r.PIECE_STATE.PENDING,this.flagNum++)},t.prototype.getBombNum=function(){return this.bombNum},t.prototype.getFlagNum=function(){return this.flagNum},t.prototype.getMaxLevel=function(){return this.colNum*this.colNum-1},t.prototype.judgeWin=function(){for(var e=0,t=0;t<this.colNum;t++)for(var o=0;o<this.colNum;o++)this.pieceMap[t][o].state===r.PIECE_STATE.OPEN&&e++;e===Math.pow(this.colNum,2)-this.bombNum&&this.mineScene.overGame(!0)},t.prototype.reset=function(e){this.resetBlank(),this.resetBombs(e),this.resetHintsAndMask()},t.prototype.resetBlank=function(){for(var e=0;e<this.colNum;e++)for(var t=0;t<this.colNum;t++)this.pieceMap[e][t].type=r.PIECE_TYPE.OPEN0},t.prototype.resetBombs=function(e){this.bombNum=e,this.flagNum=e;for(var t=[],o=0;o<this.colNum;o++)for(var i=0;i<this.colNum;i++)t.push({x:o,y:i});for(var s=0;s<e;s++){var c=Math.random()*t.length|0,n=t[c];cc.log(n),this.pieceMap[n.x][n.y].type=r.PIECE_TYPE.BOMB,t.splice(c,1)}},t.prototype.resetHintsAndMask=function(){for(var e=0;e<this.colNum;e++)for(var t=function(t){if(o.pieceMap[e][t].type!==r.PIECE_TYPE.BOMB){var i=o.getRoundPieces(e,t),s=0;i.forEach(function(e){e.type===r.PIECE_TYPE.BOMB&&s++}),o.pieceMap[e][t].type=s}o.pieceMap[e][t].state=r.PIECE_STATE.PENDING},o=this,i=0;i<this.colNum;i++)t(i)},t.prototype.getRoundPieces=function(e,t){var o=[];return e>=1&&o.push(this.pieceMap[e-1][t]),e>=1&&t<=this.colNum-2&&o.push(this.pieceMap[e-1][t+1]),t<=this.colNum-2&&o.push(this.pieceMap[e][t+1]),e<=this.colNum-2&&t<=this.colNum-2&&o.push(this.pieceMap[e+1][t+1]),e<=this.colNum-2&&o.push(this.pieceMap[e+1][t]),e<=this.colNum-2&&t>=1&&o.push(this.pieceMap[e+1][t-1]),t>=1&&o.push(this.pieceMap[e][t-1]),e>=1&&t>=1&&o.push(this.pieceMap[e-1][t-1]),o},t.prototype.showBlank=function(e){for(var t=[e];t.length>0;){var o=t.pop();if(o.type===r.PIECE_TYPE.OPEN0)o.state=r.PIECE_STATE.OPEN,this.getRoundPieces(o.x,o.y).forEach(function(e){e.state===r.PIECE_STATE.PENDING&&t.push(e)});else o.type>=r.PIECE_TYPE.OPEN1&&o.type<=r.PIECE_TYPE.OPEN8&&(o.state=r.PIECE_STATE.OPEN)}},t.prototype.showAll=function(){for(var e=0;e<this.colNum;e++)for(var t=0;t<this.colNum;t++)this.pieceMap[e][t].state=r.PIECE_STATE.OPEN},t.prototype.showRest=function(){for(var e=!0,t=0;t<this.colNum;t++)for(var o=0;o<this.colNum;o++)this.pieceMap[t][o].state===r.PIECE_STATE.PENDING&&(this.pieceMap[t][o].state=r.PIECE_STATE.OPEN,this.pieceMap[t][o].type===r.PIECE_TYPE.BOMB&&(e=!1));return e},__decorate([n(cc.Prefab)],t.prototype,"piecePrefab",void 0),__decorate([n(cc.Integer)],t.prototype,"colNum",void 0),__decorate([n(cc.Integer)],t.prototype,"colSpace",void 0),__decorate([n(cc.Float)],t.prototype,"pressTime",void 0),t=__decorate([c,a],t)}(cc.Component);o.Board=p,cc._RF.pop()},{"./MineConstans":"MineConstans","./MinePiece":"MinePiece"}],PuzzleBoard:[function(e,t,o){"use strict";cc._RF.push(t,"f9b13Qa7CZHRZEtlGELlUrB","PuzzleBoard"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./PuzzlePiece"),r=cc._decorator,s=r.ccclass,c=r.property,n=(r.executeInEditMode,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.piecePrefab=null,t.colNum=5,t.colSpace=5,t.colWidth=0,t.blankPiece=null,t.puzzleScene=null,t}return __extends(t,e),t.prototype.init=function(e){this.puzzleScene=e,this.addListeners()},t.prototype.reset=function(e){this.colNum=e,this.colWidth=(this.node.width-this.colSpace*(this.colNum+1))/this.colNum,this.node.removeAllChildren(),this.pieceMap=[];for(var t=0;t<this.colNum;t++){this.pieceMap[t]=[];for(var o=0;o<this.colNum;o++){var r=cc.instantiate(this.piecePrefab);this.node.addChild(r),r.x=t*(this.colWidth+this.colSpace)+this.colSpace,r.y=o*(this.colWidth+this.colSpace)+this.colSpace,this.pieceMap[t][o]=r.getComponent(i.Piece),this.pieceMap[t][o].init(t,o,this.colNum,this.colWidth),this.pieceMap[t][o].isBlank&&(this.blankPiece=this.pieceMap[t][o])}}this.shuffle()},t.prototype.shuffle=function(){for(var e=0;e<1e3;e++){var t=this.getNearPieces(this.blankPiece),o=Math.floor(Math.random()*t.length);this.exchangeTwoPiece(this.blankPiece,t[o])}},t.prototype.onBoadTouch=function(e){var t=e.getLocation(),o=this.node.convertToNodeSpaceAR(t),i=Math.floor((o.x-this.colSpace)/(this.colWidth+this.colSpace)),r=Math.floor((o.y-this.colSpace)/(this.colWidth+this.colSpace));this.puzzleScene.onBoardTouch(i,r)},t.prototype.movePiece=function(e,t){for(var o=this.pieceMap[e][t],i=0,r=this.getNearPieces(o);i<r.length;i++){var s=r[i];if(s.isBlank)return this.exchangeTwoPiece(o,s),!0}return!1},t.prototype.judgeWin=function(){for(var e=0;e<this.colNum;e++)for(var t=0;t<this.colNum;t++)if(!this.pieceMap[e][t].isRight)return!1;return this.blankPiece.node.active=!0,!0},t.prototype.getNearPieces=function(e){var t=[];return e.curCol>0&&t.push(this.pieceMap[e.curCol-1][e.curRow]),e.curCol<this.colNum-1&&t.push(this.pieceMap[e.curCol+1][e.curRow]),e.curRow>0&&t.push(this.pieceMap[e.curCol][e.curRow-1]),e.curRow<this.colNum-1&&t.push(this.pieceMap[e.curCol][e.curRow+1]),t},t.prototype.exchangeTwoPiece=function(e,t){var o,i,r;this.pieceMap[t.curCol][t.curRow]=e,this.pieceMap[e.curCol][e.curRow]=t,o=[t.curCol,e.curCol],e.curCol=o[0],t.curCol=o[1],i=[t.curRow,e.curRow],e.curRow=i[0],t.curRow=i[1],r=[t.node.position,e.node.position],e.node.position=r[0],t.node.position=r[1]},t.prototype.addListeners=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onBoadTouch,this)},t.prototype.removeListeners=function(){},__decorate([c(cc.Prefab)],t.prototype,"piecePrefab",void 0),__decorate([c(cc.Integer)],t.prototype,"colNum",void 0),__decorate([c(cc.Integer)],t.prototype,"colSpace",void 0),t=__decorate([s],t)}(cc.Component));o.PuzzleBoard=n,cc._RF.pop()},{"./PuzzlePiece":"PuzzlePiece"}],PuzzleConstants:[function(e,t,o){"use strict";var i;cc._RF.push(t,"d89d7sU+zdF0KOaog5T9QzY","PuzzleConstants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.STATE||(o.STATE={}))[i.NONE=0]="NONE",i[i.READY=1]="READY",i[i.START=2]="START",i[i.OVER=3]="OVER",cc._RF.pop()},{}],PuzzlePiece:[function(e,t,o){"use strict";cc._RF.push(t,"4b1b5qWuY9FS6vyp1qWoUJ4","PuzzlePiece"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"isRight",{get:function(){return this.curCol===this.oriCol&&this.curRow===this.oriRow},enumerable:!0,configurable:!0}),t.prototype.init=function(e,t,o,i){this.oriCol=e,this.oriRow=t,this.curCol=e,this.curRow=t;var r=this.node.addComponent(cc.Sprite);r.spriteFrame=new cc.SpriteFrame(this.texture);var s=r.spriteFrame.getRect(),c=s.width/o,n=s.height/o,a=e*c,p=(o-t-1)*n,h=cc.rect(a,p,c,n);r.spriteFrame.setRect(h),this.node.width=i,this.node.height=i,this.isBlank=this.oriCol===o-1&&0===this.oriRow,this.isBlank&&(this.node.active=!1)},__decorate([s(cc.Texture2D)],t.prototype,"texture",void 0),t=__decorate([r],t)}(cc.Component);o.Piece=c,cc._RF.pop()},{}],PuzzleScene:[function(e,t,o){"use strict";cc._RF.push(t,"c06b53OK21HfoqRmsnlNUNX","PuzzleScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./PuzzleConstants"),r=e("./PuzzleBoard"),s=e("../G"),c=e("./PuzzleTimer"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.timer=null,t.winPanel=null,t.level=3,t.state=i.STATE.NONE,t}return __extends(t,e),t.prototype.start=function(){this.addListeners(),this.board.init(this),this.startGame()},t.prototype.startGame=function(){this.winPanel.active=!1,this.state=i.STATE.START,this.board.reset(this.level),this.timer.reset(),this.timer.run()},t.prototype.overGame=function(){this.winPanel.active=!0,this.state=i.STATE.OVER,this.timer.stop(),s.G.gameRoot.showMaskMessage("你坚持了"+this.timer.time.toFixed(1)+"秒",{label:"呵呵"})},t.prototype.onBoardTouch=function(e,t){(this.state=i.STATE.START)&&(this.board.movePiece(e,t)?this.board.judgeWin()&&this.overGame():s.G.gameRoot.showTip("不符合规则"))},t.prototype.onBtnLevelEasy=function(){this.level=3,this.startGame()},t.prototype.onBtnLevelNormal=function(){this.level=5,this.startGame()},t.prototype.onBtnLevelHard=function(){this.level=10,this.startGame()},t.prototype.onBtnReturn=function(){s.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame()},t.prototype.addListeners=function(){},t.prototype.removeListeners=function(){},__decorate([p(r.PuzzleBoard)],t.prototype,"board",void 0),__decorate([p(c.Timer)],t.prototype,"timer",void 0),__decorate([p(cc.Node)],t.prototype,"winPanel",void 0),t=__decorate([a],t)}(cc.Component);o.PuzzleScene=h,cc._RF.pop()},{"../G":"G","./PuzzleBoard":"PuzzleBoard","./PuzzleConstants":"PuzzleConstants","./PuzzleTimer":"PuzzleTimer"}],PuzzleTimer:[function(e,t,o){"use strict";cc._RF.push(t,"0e5087jnptHobsyq50wncmT","PuzzleTimer"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timerLabel=null,t.isRunning=!1,t.time=null,t}return __extends(t,e),t.prototype.run=function(){this.time=0,this.schedule(this.tick,.1)},t.prototype.tick=function(){this.time+=.1,this.timerLabel.string=this.time.toFixed(1)+" s"},t.prototype.stop=function(){this.unschedule(this.tick)},t.prototype.reset=function(){this.time=0,this.timerLabel.string="0.0 s"},__decorate([s(cc.Label)],t.prototype,"timerLabel",void 0),t=__decorate([r],t)}(cc.Component);o.Timer=c,cc._RF.pop()},{}],ReversiAI:[function(e,t,o){"use strict";cc._RF.push(t,"f554edBfB9EGb5YaGb6mEq/","ReversiAI"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ReversiConstants"),r=function(){function e(e){this.board=e}return e.prototype.getNextCoor=function(){for(var e=[],t=0;t<this.board.pieceMap.length;t++)for(var o=0;o<this.board.pieceMap[t].length;o++)if(this.board.pieceMap[t][o].color===i.NONE&&this.board.canPlace(i.WHITE,cc.v2(t,o))){if(0===t||0===o||t===this.board.pieceMap.length-1||o===this.board.pieceMap[t].length-1)return cc.v2(t,o);e.push(cc.v2(t,o))}return e[Math.floor(Math.random()*e.length)]},e}();o.ReversiAI=r,cc._RF.pop()},{"./ReversiConstants":"ReversiConstants"}],ReversiBoard:[function(e,t,o){"use strict";cc._RF.push(t,"80923WSrblNDr5l6s/fRBrL","ReversiBoard"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ReversiPiece"),r=e("./ReversiConstants"),s=cc._decorator,c=s.ccclass,n=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colsSum=8,t.rowsSum=8,t.graphics=null,t.graphics2=null,t.tileWidth=0,t.startX=0,t.startY=0,t.boardWidth=0,t.boardHeight=0,t.lastPiece=null,t.reversiScene=null,t}return __extends(t,e),t.prototype.init=function(e){this.reversiScene=e,this.tileWidth=this.node.width/(this.colsSum+1),this.startX=this.tileWidth/2,this.startY=this.tileWidth/2,this.boardWidth=this.tileWidth*this.colsSum,this.boardHeight=this.tileWidth*this.rowsSum,this.reset(),this.addListeners()},t.prototype.reset=function(){this.graphics.clear(),this.graphics2.clear(),this.graphics.strokeColor=cc.Color.BLACK;for(var e=0;e<this.colsSum+1;e++)this.graphics.moveTo(this.startX+e*this.tileWidth,this.startY),this.graphics.lineTo(this.startX+e*this.tileWidth,this.startY+this.boardHeight),this.graphics.stroke();for(var t=0;t<this.rowsSum+1;t++)this.graphics.moveTo(this.startX,this.startY+t*this.tileWidth),this.graphics.lineTo(this.startX+this.boardWidth,this.startY+t*this.tileWidth),this.graphics.stroke();this.pieceMap=[];for(e=0;e<this.colsSum;e++){this.pieceMap[e]=[];for(t=0;t<this.rowsSum;t++)this.pieceMap[e][t]=new i.ReversiPiece(e,t,r.NONE)}this.placeBlack(cc.v2(Math.floor(this.colsSum/2)-1,Math.floor(this.rowsSum/2)-1)),this.placeBlack(cc.v2(Math.floor(this.colsSum/2),Math.floor(this.rowsSum/2))),this.placeWhite(cc.v2(cc.v2(Math.floor(this.colsSum/2)-1,Math.floor(this.rowsSum/2)))),this.placeWhite(cc.v2(cc.v2(Math.floor(this.colsSum/2),Math.floor(this.rowsSum/2)-1)))},t.prototype.refresh=function(){this.graphics2.clear();for(var e=0;e<this.colsSum;e++)for(var t=0;t<this.rowsSum;t++)this.pieceMap[e][t].color===r.BLACK?(this.graphics2.strokeColor=cc.Color.BLACK,this.graphics2.fillColor=cc.Color.BLACK,this.graphics2.circle(this.startX+e*this.tileWidth+this.tileWidth/2,this.startY+t*this.tileWidth+this.tileWidth/2,.45*this.tileWidth),this.graphics2.fill()):this.pieceMap[e][t].color===r.WHITE&&(this.graphics2.strokeColor=cc.Color.WHITE,this.graphics2.fillColor=cc.Color.WHITE,this.graphics2.circle(this.startX+e*this.tileWidth+this.tileWidth/2,this.startY+t*this.tileWidth+this.tileWidth/2,.45*this.tileWidth),this.graphics2.fill())},t.prototype.placeBlack=function(e){this.pieceMap[e.x][e.y]=new i.ReversiPiece(e.x,e.y,r.BLACK),this.lastPiece=this.pieceMap[e.x][e.y],this.refresh()},t.prototype.placeWhite=function(e){this.pieceMap[e.x][e.y]=new i.ReversiPiece(e.x,e.y,r.WHITE),this.lastPiece=this.pieceMap[e.x][e.y],this.refresh()},t.prototype.getPieceByCoor=function(e){return this.pieceMap[e.x][e.y]},t.prototype.onTouched=function(e){var t=this.node.convertToNodeSpaceAR(e.getLocation());if(!(t.x<this.startX||t.y<this.startY||t.x>this.startX+this.boardWidth||t.y>this.startY+this.boardHeight)){var o=this.getCoorByPos(t);this.reversiScene.onBoardTouched(o)}},t.prototype.getCoorByPos=function(e){var t=Math.round((e.x-this.startX-this.tileWidth/2)/this.tileWidth),o=Math.round((e.y-this.startY-this.tileWidth/2)/this.tileWidth);return cc.v2(t,o)},t.prototype.nearPiece=function(e,t){switch(t){case 1:if(0!==e.x)return this.pieceMap[e.x-1][e.y];break;case 2:if(0!==e.x&&e.y!==this.rowsSum-1)return this.pieceMap[e.x-1][e.y+1];break;case 3:if(e.y!==this.rowsSum-1)return this.pieceMap[e.x][e.y+1];break;case 4:if(e.x!==this.colsSum-1&&e.y!==this.rowsSum-1)return this.pieceMap[e.x+1][e.y+1];break;case 5:if(e.x!==this.colsSum-1)return this.pieceMap[e.x+1][e.y];break;case 6:if(e.x!==this.colsSum-1&&0!==e.y)return this.pieceMap[e.x+1][e.y-1];break;case 7:if(0!==e.y)return this.pieceMap[e.x][e.y-1];break;case 8:if(0!==e.x&&0!==e.y)return this.pieceMap[e.x-1][e.y-1]}return null},t.prototype.judgePass=function(e,t,o){var i=t;if(null===(i=this.nearPiece(t,o)))return!1;for(;i.color===-e;){if(null===(i=this.nearPiece(i,o)))return!1;if(i.color===e)return!0}return!1},t.prototype.changePass=function(e,t){for(var o=this.nearPiece(e,t);o.color===-this.reversiScene.state;)o.color=e.color,o=this.nearPiece(o,t);this.refresh()},t.prototype.canPlace=function(e,t){for(var o=1;o<=8;o++){if(this.judgePass(e,this.getPieceByCoor(t),o))return!0;if(8===o)return!1}},t.prototype.judgeMoveable=function(e){for(var t=null,o=0;o<this.colsSum;o++)for(var i=0;i<this.rowsSum;i++)if((t=this.pieceMap[o][i]).color===r.NONE)for(var s=1;s<=8;s++)if(this.judgePass(e,t,s))return!0;return!1},t.prototype.judgeWin=function(){var e=this.judgeMoveable(this.lastPiece.color),t=this.judgeMoveable(-this.lastPiece.color);return!e&&!t},t.prototype.getPieceCount=function(){for(var e=0,t=0,o=0;o<this.pieceMap.length;o++)for(var i=0;i<this.pieceMap[o].length;i++)this.pieceMap[o][i].color===r.BLACK?e++:this.pieceMap[o][i].color===r.WHITE&&t++;return{blackPieceSum:e,whitePieceSum:t}},t.prototype.addListeners=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouched,this)},t.prototype.removeListeners=function(){},__decorate([n(cc.Integer)],t.prototype,"colsSum",void 0),__decorate([n(cc.Integer)],t.prototype,"rowsSum",void 0),__decorate([n(cc.Graphics)],t.prototype,"graphics",void 0),__decorate([n(cc.Graphics)],t.prototype,"graphics2",void 0),t=__decorate([c],t)}(cc.Component);o.ReversiBoard=a,cc._RF.pop()},{"./ReversiConstants":"ReversiConstants","./ReversiPiece":"ReversiPiece"}],ReversiConstants:[function(e,t,o){"use strict";cc._RF.push(t,"42661F1JzZNuZUWFOTg6E1t","ReversiConstants"),Object.defineProperty(o,"__esModule",{value:!0}),o.NONE=0,o.BLACK=1,o.WHITE=-1,cc._RF.pop()},{}],ReversiPiece:[function(e,t,o){"use strict";cc._RF.push(t,"bdfa7e/LeBNGpN93hwoveof","ReversiPiece"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(e,t,o){this.x=e,this.y=t,this.color=o};o.ReversiPiece=i,cc._RF.pop()},{}],ReversiScene:[function(e,t,o){"use strict";cc._RF.push(t,"05ff4fnZAdCwZScbk1f0GpO","ReversiScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ReversiBoard"),r=e("./ReversiAI"),s=e("./ReversiConstants"),c=e("../G"),n=cc._decorator,a=n.ccclass,p=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.blackScoreLabel=null,t.whiteScoreLabel=null,t.ai=null,t.state=s.NONE,t}return __extends(t,e),t.prototype.start=function(){this.board.init(this),this.ai=new r.ReversiAI(this.board),this.startGame()},t.prototype.startGame=function(){this.state=s.BLACK,this.board.reset(),this.blackScoreLabel.string="2",this.whiteScoreLabel.string="2",c.G.gameRoot.showTip("你是黑棋你先走")},t.prototype.overGame=function(){var e=this.board.getPieceCount(),t=e.blackPieceSum,o=e.whitePieceSum;t>o?(cc.log("白棋胜"),c.G.gameRoot.showMaskMessage("你赢了阿尔法二狗！",{label:"朕知道了",cb:function(){},target:this})):t<o?(cc.log("黑棋胜"),c.G.gameRoot.showMaskMessage("你输给了阿尔法二狗！",{label:"服了",cb:function(){},target:this},{label:"不服",cb:function(){},target:this})):(cc.log("平局"),c.G.gameRoot.showMaskMessage("你和阿尔法二狗五五开!",{label:"朕知道了",cb:function(){},target:this})),this.state=s.NONE},t.prototype.updateScore=function(){var e=this.board.getPieceCount(),t=e.blackPieceSum,o=e.whitePieceSum;this.blackScoreLabel.string=t+"",this.whiteScoreLabel.string=o+""},t.prototype.onBtnReturn=function(){c.G.returnHall()},t.prototype.onBtnRestart=function(){this.startGame()},t.prototype.runAi=function(){var e=this;this.scheduleOnce(function(){var t=e.ai.getNextCoor();e.board.placeWhite(t);for(var o=e.board.getPieceByCoor(t),i=1;i<=8;i++)e.board.judgePass(s.WHITE,o,i)&&e.board.changePass(o,i);e.updateScore(),e.board.judgeWin()?e.overGame():e.board.judgeMoveable(s.BLACK)?e.state=s.BLACK:(c.G.gameRoot.showTip("黑棋无地可下，白棋继续"),e.runAi())},1)},t.prototype.onBoardTouched=function(e){switch(this.state){case s.NONE:break;case s.BLACK:var t=this.board.getPieceByCoor(e);if(t.color!==s.NONE)return void c.G.gameRoot.showTip("这里有子了，你是不是傻");if(!this.board.canPlace(this.state,e))return void c.G.gameRoot.showTip("不符合规则");this.board.placeBlack(e),t=this.board.getPieceByCoor(e);for(var o=1;o<=8;o++)this.board.judgePass(s.BLACK,t,o)&&this.board.changePass(t,o);this.updateScore(),this.board.judgeWin()?this.overGame():this.board.judgeMoveable(s.WHITE)?(this.state=s.WHITE,this.runAi()):c.G.gameRoot.showTip("白棋无地可下，黑棋继续");break;case s.WHITE:}},__decorate([p(i.ReversiBoard)],t.prototype,"board",void 0),__decorate([p(cc.Label)],t.prototype,"blackScoreLabel",void 0),__decorate([p(cc.Label)],t.prototype,"whiteScoreLabel",void 0),t=__decorate([a],t)}(cc.Component);o.ReversiScene=h,cc._RF.pop()},{"../G":"G","./ReversiAI":"ReversiAI","./ReversiBoard":"ReversiBoard","./ReversiConstants":"ReversiConstants"}],Streak:[function(e,t,o){"use strict";cc._RF.push(t,"7d2a9UGfIdOHJj/cCvXlEIj","Streak"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.g=null,t}return __extends(t,e),t.prototype.start=function(){this.node.parent.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.parent.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.parent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.parent.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.parent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.onTouchStart=function(e){var t=this.node.parent.convertToNodeSpaceAR(e.getLocation());this.g.circle(t.x,t.y,5),this.g.fill(),this.g.moveTo(t.x,t.y)},t.prototype.onTouchMove=function(e){var t=this.node.parent.convertToNodeSpaceAR(e.getLocation());this.g.lineTo(t.x,t.y),this.g.stroke(),this.g.moveTo(t.x,t.y)},t.prototype.onTouchEnd=function(e){var t=this.node.parent.convertToNodeSpaceAR(e.getLocation());this.g.circle(t.x,t.y,5),this.g.fill(),this.g.clear()},__decorate([s(cc.Graphics)],t.prototype,"g",void 0),t=__decorate([r],t)}(cc.Component);o.Streak=c,cc._RF.pop()},{}],TetrisBoard:[function(e,t,o){"use strict";cc._RF.push(t,"c50e6LtA35NprKFbQ2Byit0","TetrisBoard"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./TetrisPiece"),r=cc._decorator,s=r.ccclass,c=r.property,n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colsNum=0,t.piecePrefab=null,t.frameTime=1,t.isStart=!1,t.pastTime=0,t.rowsNum=0,t.gridWidth=0,t.player={pos:cc.v2(0,0),matrix:null,score:0},t.nextBlock="囧",t}return __extends(t,e),t.prototype.onLoad=function(){this.gridWidth=this.node.width/this.colsNum,this.rowsNum=cc.director.getVisibleSize().height/this.gridWidth|0,this.pieceMap=[];for(var e=0;e<this.rowsNum;e++){this.pieceMap[e]=[];for(var t=0;t<this.colsNum;t++){var o=cc.instantiate(this.piecePrefab);this.node.addChild(o),o.width=this.gridWidth,o.height=this.gridWidth,o.x=t*this.gridWidth+o.width/2,o.y=e*this.gridWidth+o.height/2,this.pieceMap[e][t]=o.getComponent(i.Piece)}}},t.prototype.init=function(e){this.tetrisScene=e},t.prototype.reset=function(){this.arena=this.createMatrix(this.colsNum,this.rowsNum),this.playerReset(),this.clear(),this.draw(),this.isStart=!0},t.prototype.stop=function(){this.isStart=!1},t.prototype.clear=function(){for(var e=0;e<this.rowsNum;e++)for(var t=0;t<this.colsNum;t++)this.pieceMap[e][t].hide()},t.prototype.createMatrix=function(e,t){for(var o=[];t--;)o.push(new Array(e).fill(0));return o},t.prototype.drawMatrix=function(e,t){var o=this;e.forEach(function(e,i){e.forEach(function(e,r){0!==e&&o.pieceMap[i+t.y][r+t.x].show()})})},t.prototype.draw=function(){this.clear(),this.drawMatrix(this.arena,cc.v2(0,0)),this.drawMatrix(this.player.matrix,this.player.pos)},t.prototype.playerReset=function(){if(this.player.matrix=this.createBlock(this.nextBlock),this.player.pos.y=this.rowsNum-this.player.matrix.length,this.player.pos.x=(this.arena[0].length/2|0)-(this.player.matrix[0].length/2|0),this.collide()&&this.tetrisScene.stopGame(this.player.score),Math.random()<.01)this.nextBlock="囧";else{var e="TJLOSZIX";this.nextBlock=e[e.length*Math.random()|0]}this.tetrisScene.updateHint(this.nextBlock)},t.prototype.playerDrop=function(){this.player.pos.y--,this.collide()&&(this.player.pos.y++,this.merge(),this.playerReset(),this.arenaSweep(),this.tetrisScene.updateScore(this.player.score)),this.draw()},t.prototype.playerMove=function(e){this.player.pos.x+=e,this.collide()&&(this.player.pos.x-=e),this.draw()},t.prototype.playerRotate=function(e){var t=this.player.pos.x,o=1;for(this.rotate(this.player.matrix,e);this.collide();)if(this.player.pos.x+=o,(o=-(o+(o>0?1:-1)))>this.player.matrix.length)return this.rotate(this.player.matrix,-e),void(this.player.pos.x=t);this.draw()},t.prototype.arenaSweep=function(){var e=1;e:for(var t=0;t<this.arena[0].length-1;t++){for(var o=0;o<this.arena.length;o++)if(0===this.arena[t][o])continue e;var i=this.arena.splice(t,1)[0].fill(0);this.arena.push(i),t++,this.player.score+=10*e,e*=2}},t.prototype.collide=function(){for(var e=this.player.matrix,t=this.player.pos,o=0;o<e.length;o++)for(var i=0;i<e[o].length;i++)if(0!==e[o][i]&&0!==(this.arena[o+t.y]&&this.arena[o+t.y][i+t.x]))return!0;return!1},t.prototype.merge=function(){var e=this;this.player.matrix.forEach(function(t,o){t.forEach(function(t,i){0!==t&&(e.arena[o+e.player.pos.y][i+e.player.pos.x]=t)})})},t.prototype.rotate=function(e,t){for(var o=0;o<e.length;o++)for(var i=0;i<o;i++)r=[e[o][i],e[i][o]],e[i][o]=r[0],e[o][i]=r[1];var r;t>0?e.forEach(function(e){return e.reverse()}):e.reverse()},t.prototype.createBlock=function(e){return"I"===e?[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]:"L"===e?[[0,2,0],[0,2,0],[0,2,2]]:"J"===e?[[0,3,0],[0,3,0],[3,3,0]]:"O"===e?[[4,4],[4,4]]:"Z"===e?[[5,5,0],[0,5,5],[0,0,0]]:"S"===e?[[0,6,6],[6,6,0],[0,0,0]]:"T"===e?[[0,7,0],[7,7,7],[0,0,0]]:"X"===e?[[1,0,1],[0,1,0],[1,0,1]]:"囧"===e?[[1,1,1,1,1,1,1],[1,0,1,0,1,0,1],[1,1,0,0,0,1,1],[1,0,0,0,0,0,1],[1,0,1,1,1,0,1],[1,0,1,0,1,0,1],[1,1,1,1,1,1,1]].reverse():void 0},t.prototype.update=function(e){this.isStart&&(this.pastTime+=e,this.pastTime>=this.frameTime&&(this.playerDrop(),this.pastTime=0))},__decorate([c(cc.Integer)],t.prototype,"colsNum",void 0),__decorate([c(cc.Prefab)],t.prototype,"piecePrefab",void 0),__decorate([c(cc.Float)],t.prototype,"frameTime",void 0),t=__decorate([s],t)}(cc.Component);o.Board=n,cc._RF.pop()},{"./TetrisPiece":"TetrisPiece"}],TetrisConstants:[function(e,t,o){"use strict";var i;cc._RF.push(t,"5dda65IwMBO4peY9Ktr0VrB","TetrisConstants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.STATE||(o.STATE={}))[i.NONE=0]="NONE",i[i.START=1]="START",i[i.OVER=2]="OVER",cc._RF.pop()},{}],TetrisPiece:[function(e,t,o){"use strict";cc._RF.push(t,"8d09eH0obdDS6b119IOSvSi","TetrisPiece"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.hide=function(){this.node.active=!1},t.prototype.show=function(){this.node.active=!0},t=__decorate([r],t)}(cc.Component));o.Piece=s,cc._RF.pop()},{}],TetrisScene:[function(e,t,o){"use strict";cc._RF.push(t,"f98a8vySGJO/rrzqvUD1fRq","TetrisScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./TetrisBoard"),r=e("./TetrisConstants"),s=e("../G"),c=cc._decorator,n=c.ccclass,a=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.scoreLabel=null,t.nextLabel=null,t.state=r.STATE.NONE,t}return __extends(t,e),t.prototype.start=function(){this.addListeners(),this.board.init(this),this.startGame()},t.prototype.startGame=function(){this.state=r.STATE.START,this.board.reset(),this.updateScore(0)},t.prototype.stopGame=function(e){var t=this;this.state=r.STATE.OVER,this.board.stop(),s.G.gameRoot.showMaskMessage("无聊指数："+e,{label:"再来",cb:function(){t.startGame()},target:this},{label:"溜了",cb:function(){s.G.returnHall()},target:this})},t.prototype.updateScore=function(e){this.scoreLabel.string=e+""},t.prototype.updateHint=function(e){this.nextLabel.string=e},t.prototype.onBtnExit=function(){this.board.stop(),s.G.returnHall()},t.prototype.onBtnLeft=function(){this.state===r.STATE.START&&this.board.playerMove(-1)},t.prototype.onBtnRight=function(){this.state===r.STATE.START&&this.board.playerMove(1)},t.prototype.onBtnRotate=function(){this.state===r.STATE.START&&this.board.playerRotate(1)},t.prototype.onBtnDrop=function(){this.state===r.STATE.START&&this.board.playerDrop()},t.prototype.addListeners=function(){var e=this;this.board.node.on(cc.Node.EventType.TOUCH_END,function(t){var o=t.getStartLocation(),i=t.getLocation(),r=i.x-o.x,s=i.y-o.y;Math.abs(r)>Math.abs(s)?r>0?e.onBtnRight():e.onBtnLeft():s>0?e.onBtnRotate():e.onBtnDrop()},this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.left:case cc.KEY.a:e.onBtnLeft();break;case cc.KEY.right:case cc.KEY.d:e.onBtnRight();break;case cc.KEY.up:case cc.KEY.w:e.onBtnRotate();break;case cc.KEY.down:case cc.KEY.s:e.onBtnDrop()}},this)},__decorate([a(i.Board)],t.prototype,"board",void 0),__decorate([a(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([a(cc.Label)],t.prototype,"nextLabel",void 0),t=__decorate([n],t)}(cc.Component);o.TetrisScene=p,cc._RF.pop()},{"../G":"G","./TetrisBoard":"TetrisBoard","./TetrisConstants":"TetrisConstants"}]},{},["M2048Board","M2048Constants","M2048Piece","M2048Scene","G","Get47Board","Get47Constants","Get47Piece","Get47Scene","Get47Score","GobangAI","GobangBoard","GobangConstants","GobangPiece","GobangScene","HallScene","JumpBlock","JumpConstants","JumpPlayer","JumpProgress","JumpScene","JumpStage","LodingScene","MineConstans","MineLevelLabel","MinePiece","MineScene","MnieBoard","PuzzleBoard","PuzzleConstants","PuzzlePiece","PuzzleScene","PuzzleTimer","ReversiAI","ReversiBoard","ReversiConstants","ReversiPiece","ReversiScene","GameRoot","Streak","TetrisBoard","TetrisConstants","TetrisPiece","TetrisScene"]);